# redis 源码简介

## redis object
字符串

集合

zset

hash

list

## 数据结构

字符串

跳跃表(skiplist)

压缩列表(ziplist)

词典(dict)

双向链表(Dlinklist)

整数集合

## redis object 和数据结构的对应关系
![](imgs/20180419-131337.png)

## 快照(AOF & RDB)

AOF:增量方式，所有写操作存入文件，会定期从新生成，从新生成的方式

１．根据当前存储的内存遍历，对于每个object 生成一个日志

２．在从新生成的过程中的请求会进入buf中，在快照结束后写入日志文件

RDB:一个在某个时间点的snapshot

## 主从同步
主从同步又两种方式：

１．从每次完全从新同步

２．主节点对于每个从节点维护一个同步的精度，连接断开重连时，根据当前的进度同步(偏移)

## cluster
命令执行

从新分片

转向

故障转移

消息